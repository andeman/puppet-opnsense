---
# Config auf firewall oder Brücken Host
opnsense::devices:
#  "%{::fqdn}":
#    url: "https://%{::fqdn}/api"
#    api_key:
#    api_secret:
#    timeout:
#    ssl_verify:
#    ca: /etc/ca/cert.pem
#    plugins:
#      - os-haproxy
  "fw01.markt.de":
    url: "https://fw01.markt.de/api"
    api_key:
    api_secret:
    timeout:
    ssl_verify:
    ca: /etc/ca/cert.pem
    plugins:
      - os-acme-client
  "fw01.dmz.markt.de":
    url: "https://fw01.markt.de/api"
    api_key:
    api_secret:
    timeout:
    ssl_verify:
    ca: /etc/ca/cert.pem
    plugins: []

opnsense::api_manager_prefix: "%{fqdn} api manager"
# werden überall installiert
opnsense::required_plugins:
  - os-firewall
opnsense::aliases:
  'my_http_ports':
    device: "%{::fqdn}"
    type: port,
    content:
      - '80'
      - '443'
    description: 'my local web ports'
    enabled: true
  'mac_alias':
    device: "%{::fqdn}"
    type: mac,
    content:
      - 'f4:90:ea'
      - '0c:4d:e9:b1:05:f0'
    description: 'My local MAC address or partial mac addresses'
    counters: true
    enabled: true

opnsense::rules:
  'allow all from lan and wan':
    device:      => 'opnsense-test.device.com',
    sequence:    => '1',
    action:      => 'pass',
    interface:
      - lan
      - wan



# Hier config auf einem Client - astuerz-test01.markt.de
opnsense::firewall::aliases:
  'mac_alias':
    device: "%{::fqdn}"
    type: mac,
    content:
      - 'f4:90:ea'
      - '0c:4d:e9:b1:05:f0'
    description: 'My local MAC address or partial mac addresses'
    counters: true
    enabled: true

opnsense::firewall::rules:
  'allow http':
    device:  fw01.markt.de
    sequence: 1
    action: pass
    direction: in
    protocol: TCP
    destination_port: http
    interface:
      - lan
  'allow https':
    device:  fw01.markt.de
    sequence: 1
    action: pass
    direction: in
    protocol: TCP
    destination_port: https
    interface:
      - lan



